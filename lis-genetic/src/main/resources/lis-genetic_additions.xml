<?xml version="1.0"?>
<classes>

  <!-- extends Annotatable: primaryIdentifier, ontologyAnnotations, publications -->
  <!-- NOTE: some maps do not have linkage groups, so we must have GeneticMap.qtls as well -->
  <class name="GeneticMap" extends="Annotatable" is-interface="true">
    <attribute name="synopsis" type="java.lang.String"/>
    <attribute name="description" type="java.lang.String"/>
    <attribute name="genotypingPlatform" type="java.lang.String"/>
    <attribute name="genotypingMethod" type="java.lang.String"/>
    <reference name="organism" referenced-type="Organism"/>
    <collection name="populations" referenced-type="Population"/>
    <collection name="linkageGroups" referenced-type="LinkageGroup" reverse-reference="geneticMap"/>
    <collection name="qtls" referenced-type="QTL" reverse-reference="geneticMap"/>
    <collection name="dataSets" referenced-type="DataSet"/>
  </class>

  <!-- a Population is simply the name of a bi-parental cross, RILs, etc. -->
  <class name="Population" is-interface="true">
    <attribute name="identifier" type="java.lang.String"/>
  </class>
  
  <!-- a linkage group is a part of a genetic map and is related to markers and QTLs -->
  <!-- marker names are stored in a |-delimited markerNames string; markers are loaded by a post-processor -->
  <!-- marker reverse reference is via LinkageGroupPosition-->
  <class name="LinkageGroup" is-interface="true" term="http://purl.obolibrary.org/obo/SO:0000018">
    <attribute name="identifier" type="java.lang.String"/>
    <attribute name="number" type="java.lang.Integer"/>
    <attribute name="length" type="java.lang.Double"/>
    <attribute name="markerNames" type="java.lang.String"/>
    <reference name="organism" referenced-type="Organism"/>
    <reference name="geneticMap" referenced-type="GeneticMap" reverse-reference="linkageGroups"/>
    <collection name="markers" referenced-type="GeneticMarker"/>
    <collection name="qtls" referenced-type="QTL" reverse-reference="linkageGroup"/>
    <collection name="dataSets" referenced-type="DataSet"/>
  </class>

  <!-- a genetic marker is a sequence feature mapped to a genome assembly; these gives its cM position on linkage groups -->
  <class name="GeneticMarker" extends="SequenceFeature" is-interface="true" term="http://purl.obolibrary.org/obo/SO:0001645" >
    <collection name="linkageGroupPositions" referenced-type="LinkageGroupPosition"/>
    <collection name="qtls" referenced-type="QTL" reverse-reference="markers"/>
  </class>

  <!-- a marker's position (in cM) on a linkage group, referenced by name -->
  <class name="LinkageGroupPosition" is-interface="true">
    <attribute name="markerName" type="java.lang.String"/>
    <attribute name="position" type="java.lang.Double"/>
    <reference name="linkageGroup" referenced-type="LinkageGroup"/>
  </class>

  <!-- QTL references a trait, resides on a linkage group (on a genetic map), and has associated markers -->
  <!-- marker names are stored in a |-delimited markerNames string; markers are loaded by a post-processor -->
  <!-- NOTE 1: some maps do not have linkage groups, so we must have QTL.geneticMap reference here -->
  <!-- NOTE 2: genes are populated by a post-processor -->
  <class name="QTL" is-interface="true" term="http://purl.obolibrary.org/obo/SO:0001645">
    <attribute name="identifier" type="java.lang.String"/>
    <attribute name="lod" type="java.lang.Double"/>
    <attribute name="likelihoodRatio" type="java.lang.Double"/>
    <attribute name="markerR2" type="java.lang.Double"/>
    <attribute name="peak" type="java.lang.Double"/>
    <attribute name="start" type="java.lang.Double"/>
    <attribute name="end" type="java.lang.Double"/>
    <attribute name="markerNames" type="java.lang.String"/>
    <reference name="organism" referenced-type="Organism"/>
    <reference name="trait" referenced-type="Trait" reverse-reference="qtls"/>
    <reference name="linkageGroup" referenced-type="LinkageGroup" reverse-reference="qtls"/>
    <reference name="geneticMap" referenced-type="GeneticMap" reverse-reference="qtls"/>
    <collection name="markers" referenced-type="GeneticMarker" reverse-reference="qtls"/>
    <collection name="genes" referenced-type="Gene" reverse-reference="qtls"/>
    <collection name="dataSets" referenced-type="DataSet"/>
  </class>

  <!-- A Trait is an experimentally measured phenotype for a QTL, which has ontology annotations -->
  <!-- because description is specific to an experiment, it has a single dataset which keys it along with primaryIdentifier -->
  <class name="Trait" extends="Annotatable" is-interface="true" term="https://browser.planteome.org/amigo/term/TO:0000387">
    <attribute name="description" type="java.lang.String"/>
    <reference name="dataSet" referenced-type="DataSet"/>
    <collection name="qtls" referenced-type="QTL" reverse-reference="trait"/>
  </class>
  
  <!-- Genes can be associated with QTLs that span them, via overlapping markers -->
  <class name="Gene" is-interface="true">
    <collection name="qtls" referenced-type="QTL" reverse-reference="genes"/>
  </class>

</classes>
