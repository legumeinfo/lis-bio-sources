<?xml version="1.0"?>
<classes>

  <!-- GWAS extends Annotatable for the standard Publication support (and there's probably an ontology with GWAS in it) -->  
  <!-- Strain	Williams82 -->
  <!-- Identifier	KGK20170707.1 -->
  <!-- Name	Zhang, Hao et al. 2015 -->
  <!-- PlatformName	IlluminaGoldenGate -->
  <!-- PlatformDetails	 -->
  <!-- DOI	10.1111/pbr.12305 -->
  <class name="GWAS" extends="Annotatable" is-interface="true">
    <reference name="organism" referenced-type="Organism"/>
    <reference name="dataSet" referenced-type="DataSet"/>
    <attribute name="name" type="java.lang.String"/>
    <attribute name="description" type="java.lang.String"/>
    <attribute name="synopsis" type="java.lang.String"/>
    <attribute name="platformName" type="java.lang.String"/>
    <attribute name="platformDetails" type="java.lang.String"/>
    <attribute name="curationNotes" type="java.lang.String"/>
    <collection name="results" referenced-type="GWASResult" reverse-reference="gwas"/>
    <collection name="qtls" referenced-type="QTL" reverse-reference="gwas"/>
  </class>

  <!-- A GWAS QTL is a collection of GWASResults with the same identifier -->
  <class name="QTL" is-interface="true" term="http://purl.obolibrary.org/obo/SO:0001645">
    <attribute name="identifier" type="java.lang.String"/>
    <reference name="phenotype" referenced-type="Phenotype" reverse-reference="qtls"/>
    <reference name="gwas" referenced-type="GWAS" reverse-reference="qtls"/>
    <collection name="gwasResults" referenced-type="GWASResult" reverse-reference="qtl"/>
  </class>

  <!-- GWASResult connects a marker to a phenotype with a p-value and LOD -->
  <class name="GWASResult" is-interface="true">
    <attribute name="pValue" type="java.lang.Double"/>
    <attribute name="lod" type="java.lang.Double"/>
    <reference name="phenotype" referenced-type="Phenotype"/>
    <reference name="marker" referenced-type="GeneticMarker" reverse-reference="gwasResults"/>
    <reference name="gwas" referenced-type="GWAS" reverse-reference="results"/>
    <reference name="qtl" referenced-type="QTL" reverse-reference="gwasResults"/>
  </class>

  <!-- associate a phenotype with QTLs -->
  <class name="Phenotype" extends="BioEntity" is-interface="true" term="http://semanticscience.org/resource/SIO_010056">
    <collection name="qtls" referenced-type="QTL" reverse-reference="phenotype"/>
  </class>

  <!-- the marker type will typically be "SNP", but could be another type -->
  <class name="GeneticMarker" extends="SequenceFeature" is-interface="true">
    <collection name="gwasResults" referenced-type="GWASResult" reverse-reference="marker"/>
  </class>

</classes>
