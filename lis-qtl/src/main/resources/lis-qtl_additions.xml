<?xml version="1.0"?>
<classes>

  <class name="Organism" is-interface="true">
    <attribute name="abbreviation" type="java.lang.String"/>
  </class>

  <!-- extends Annotatable: primaryIdentifier, ontologyAnnotations, publications -->
  <class name="GeneticMap" extends="Annotatable" is-interface="true">
    <attribute name="synopsis" type="java.lang.String"/>
    <attribute name="experimentDescription" type="java.lang.String"/>
    <reference name="organism" referenced-type="Organism"/>
    <collection name="mappingParents" referenced-type="Strain"/>
    <collection name="linkageGroups" referenced-type="LinkageGroup" reverse-reference="geneticMap"/>
    <collection name="traits" referenced-type="Trait" reverse-reference="geneticMap"/>
    <collection name="qtls" referenced-type="QTL" reverse-reference="geneticMap"/>
    <collection name="dataSets" referenced-type="DataSet"/>
  </class>

  <class name="LinkageGroup" is-interface="true">
    <attribute name="identifier" type="java.lang.String"/>
    <reference name="organism" referenced-type="Organism"/>
    <reference name="geneticMap" referenced-type="GeneticMap" reverse-reference="linkageGroups"/>
    <collection name="qtls" referenced-type="QTL" reverse-reference="linkageGroup"/>
    <collection name="dataSets" referenced-type="DataSet"/>
  </class>

  <!-- QTL is on a trait -->
  <class name="QTL" is-interface="true" term="http://purl.obolibrary.org/obo/SO:0001645">
    <attribute name="identifier" type="java.lang.String"/>
    <attribute name="lod" type="java.lang.Double"/>
    <attribute name="likelihoodRatio" type="java.lang.Double"/>
    <attribute name="markerR2" type="java.lang.Double"/>
    <attribute name="peak" type="java.lang.Double"/>
    <attribute name="start" type="java.lang.Double"/>
    <attribute name="end" type="java.lang.Double"/>
    <reference name="organism" referenced-type="Organism"/>
    <reference name="geneticMap" referenced-type="GeneticMap" reverse-reference="qtls"/>
    <reference name="trait" referenced-type="Trait"/>
    <reference name="linkageGroup" referenced-type="LinkageGroup" reverse-reference="qtls"/>
    <collection name="spannedGenes" referenced-type="Gene"/>
    <collection name="dataSets" referenced-type="DataSet"/>
  </class>

  <!-- A Trait is a measured phenotype for a QTL, which has ontology annotations -->
  <class name="Trait" extends="Annotatable" is-interface="true">
    <attribute name="name" type="java.lang.String"/>
    <attribute name="description" type="java.lang.String"/>
    <reference name="geneticMap" referenced-type="GeneticMap" reverse-reference="traits"/>
    <collection name="qtls" referenced-type="QTL" reverse-reference="trait"/>
    <collection name="dataSets" referenced-type="DataSet"/>
  </class>
  
  <!-- we just populate GeneticMarker.secondaryIdentifier here -->
  <class name="GeneticMarker" extends="SequenceFeature" is-interface="true" term="http://purl.obolibrary.org/obo/SO:0001645" />

  <!-- relates a QTL to a marker; distinction=flanking, nearest, etc. -->
  <class name="QTLMarker" is-interface="true">
    <reference name="qtl" referenced-type="QTL"/>
    <reference name="marker" referenced-type="GeneticMarker"/>
    <attribute name="distinction" type="java.lang.String"/>
    <collection name="dataSets" referenced-type="DataSet"/>
  </class>

</classes>
